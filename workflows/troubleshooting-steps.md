# 문제 해결 절차 워크플로우

이 문서는 개발 과정에서 문제가 발생했을 때 체계적으로 접근하여 빠르고 효과적으로 해결하기 위한 가이드입니다.

## 🎯 목표
- 문제 상황 신속하고 정확한 파악
- 체계적인 문제 해결 접근
- 재발 방지를 위한 근본 원인 분석
- 해결 과정 문서화로 지식 축적

---

## 🚨 긴급도별 대응 절차

### 🔴 긴급 (Critical) - 즉시 대응
**상황**: 서비스 완전 중단, 데이터 손실, 보안 침해
**목표 대응 시간**: 15분 이내

- [ ] **즉시 상황 격리**
- [ ] **서비스 롤백 고려**
- [ ] **사용자 안내 메시지 게시**
- [ ] **백업에서 데이터 복구 준비**

### 🟡 높음 (High) - 1시간 이내 대응
**상황**: 핵심 기능 오류, 성능 심각 저하, 일부 사용자 영향
**목표 대응 시간**: 1시간 이내

### 🟢 보통 (Medium) - 24시간 이내 대응  
**상황**: 일반 기능 오류, 사용자 불편, 성능 저하
**목표 대응 시간**: 24시간 이내

### 🔵 낮음 (Low) - 1주일 이내 대응
**상황**: 사소한 버그, UI 개선, 최적화
**목표 대응 시간**: 1주일 이내

---

## 📋 기본 문제 해결 절차

### 1단계: 문제 상황 파악 (5-10분)

#### 상황 정보 수집
- [ ] **문제 발생 시점 정확히 파악**
  - 언제부터 시작되었는가?
  - 특정 동작 후 발생했는가?
- [ ] **영향 범위 확인**
  - 전체 시스템? 특정 기능? 특정 사용자?
  - 몇 명의 사용자가 영향을 받는가?
- [ ] **재현 가능성 확인**
  - 일관되게 재현되는가?
  - 특정 조건에서만 발생하는가?

#### 초기 진단
- [ ] **기본 서비스 상태 확인**
  ```bash
  # 서비스 상태
  systemctl status your-service
  docker ps
  
  # 네트워크 연결
  ping your-domain.com
  curl -I https://your-domain.com
  
  # 포트 확인
  netstat -tlnp | grep :80
  netstat -tlnp | grep :443
  ```

### 2단계: 로그 분석 (10-15분)

#### 시스템 로그 확인
- [ ] **애플리케이션 로그**
  ```bash
  tail -100 /var/log/your-app.log
  grep -i error /var/log/your-app.log | tail -20
  grep -i exception /var/log/your-app.log | tail -20
  ```
- [ ] **웹 서버 로그**
  ```bash
  tail -100 /var/log/nginx/error.log
  tail -100 /var/log/nginx/access.log
  ```
- [ ] **시스템 로그**
  ```bash
  journalctl -f  # 실시간 로그
  journalctl -p err -since "1 hour ago"
  dmesg | tail -20
  ```

#### 로그 분석 체크포인트
- [ ] **에러 메시지 패턴 확인**
- [ ] **타임스탬프와 문제 발생 시점 매칭**
- [ ] **반복되는 에러 확인**
- [ ] **경고 메시지 확인**

### 3단계: 환경 및 리소스 점검 (5-10분)

#### 시스템 리소스 확인
- [ ] **메모리 사용량**
  ```bash
  free -h
  ps aux --sort=-%mem | head -10
  ```
- [ ] **CPU 사용률**
  ```bash
  top -o %CPU
  ps aux --sort=-%cpu | head -10
  ```
- [ ] **디스크 사용량**
  ```bash
  df -h
  du -sh /var/log/*
  ```
- [ ] **네트워크 상태**
  ```bash
  ss -tuln
  netstat -i
  ```

#### 데이터베이스 상태 (해당시)
- [ ] **연결 상태 확인**
- [ ] **실행 중인 쿼리 확인**
- [ ] **락 대기 상황 확인**
- [ ] **저장 공간 확인**

### 4단계: 최근 변경사항 확인 (5분)

#### 코드 변경사항
- [ ] **최근 커밋 확인**
  ```bash
  git log --oneline -10
  git show HEAD  # 최근 변경사항 상세
  ```
- [ ] **배포 이력 확인**
- [ ] **설정 파일 변경 확인**

#### 인프라 변경사항
- [ ] **서버 설정 변경**
- [ ] **의존성 업데이트**
- [ ] **환경 변수 변경**

### 5단계: 문제 재현 및 분석 (10-20분)

#### 로컬 환경에서 재현 시도
- [ ] **동일한 조건 구성**
- [ ] **단계별 재현**
- [ ] **에러 메시지 수집**

#### 디버깅 도구 활용
- [ ] **브라우저 개발자 도구**
- [ ] **네트워크 탭 확인**
- [ ] **콘솔 에러 확인**
- [ ] **성능 프로파일링**

---

## 🔧 문제 유형별 해결 가이드

### 🌐 웹사이트 접속 불가

#### 체크리스트
- [ ] **DNS 설정 확인**
  ```bash
  nslookup your-domain.com
  dig your-domain.com
  ```
- [ ] **웹 서버 상태**
  ```bash
  systemctl status nginx
  nginx -t  # 설정 파일 문법 확인
  ```
- [ ] **SSL 인증서 확인**
  ```bash
  openssl s_client -connect your-domain.com:443
  ```
- [ ] **방화벽 설정**
  ```bash
  ufw status
  iptables -L
  ```

### 🐛 애플리케이션 에러

#### 체크리스트
- [ ] **의존성 설치 상태**
  ```bash
  npm list --depth=0
  npm audit
  ```
- [ ] **환경 변수 설정**
  ```bash
  printenv | grep APP_
  ```
- [ ] **포트 충돌 확인**
  ```bash
  lsof -i :3000
  ```
- [ ] **프로세스 상태**
  ```bash
  ps aux | grep node
  pm2 status
  ```

### 💾 데이터베이스 문제

#### PostgreSQL 체크리스트
- [ ] **연결 테스트**
  ```bash
  pg_isready -h localhost -p 5432
  ```
- [ ] **실행 중인 쿼리**
  ```sql
  SELECT pid, now() - pg_stat_activity.query_start AS duration, query 
  FROM pg_stat_activity 
  WHERE (now() - pg_stat_activity.query_start) > interval '5 minutes';
  ```
- [ ] **락 상태 확인**
  ```sql
  SELECT * FROM pg_locks WHERE NOT granted;
  ```
- [ ] **연결 수 확인**
  ```sql
  SELECT count(*) FROM pg_stat_activity;
  ```

### 🚀 성능 문제

#### 체크리스트
- [ ] **응답 시간 측정**
  ```bash
  curl -w "@curl-format.txt" -o /dev/null -s "https://your-domain.com"
  ```
- [ ] **메모리 누수 확인**
  ```bash
  valgrind --tool=memcheck your-app
  ```
- [ ] **프로파일링 도구 사용**
- [ ] **CDN 및 캐싱 상태 확인**

---

## ✅ 해결책 적용 및 검증

### 해결책 적용 전 체크리스트
- [ ] **백업 생성** (데이터, 설정 파일)
- [ ] **롤백 계획 준비**
- [ ] **테스트 환경에서 검증** (가능한 경우)
- [ ] **영향 범위 재확인**

### 해결책 적용 단계
- [ ] **단계적 적용**
- [ ] **각 단계별 결과 확인**
- [ ] **문제 해결 여부 검증**
- [ ] **부작용 발생 여부 확인**

### 적용 후 검증
- [ ] **기능 정상 작동 확인**
- [ ] **성능 지표 확인**
- [ ] **에러 로그 재확인**
- [ ] **사용자 피드백 수집**

---

## 📝 문제 해결 과정 문서화

### 문제 해결 보고서 템플릿
```markdown
# 문제 해결 보고서 - YYYY-MM-DD

## 문제 요약
- **발생 시점**: 
- **영향 범위**: 
- **긴급도**: Critical/High/Medium/Low
- **담당자**: 

## 문제 상세
### 증상
- [구체적인 문제 상황 설명]

### 발생 환경
- OS: 
- 브라우저: 
- 애플리케이션 버전: 

## 원인 분석
### 직접적 원인
- [즉시적인 문제 원인]

### 근본 원인
- [문제가 발생하게 된 근본적 이유]

## 해결 과정
### 시도한 방법들
1. [시도 1] - 결과: 성공/실패
2. [시도 2] - 결과: 성공/실패

### 최종 해결 방법
- [실제로 문제를 해결한 방법]

## 예방 조치
- [ ] [재발 방지를 위한 조치 1]
- [ ] [재발 방지를 위한 조치 2]

## 교훈
- [이번 경험에서 얻은 교훈]
- [개선해야 할 프로세스]
```

---

## 🔄 사후 관리 및 예방

### 근본 원인 분석 (Root Cause Analysis)
- [ ] **5 Why 기법 적용**
  - Why 1: 왜 이 문제가 발생했는가?
  - Why 2: 왜 그런 상황이 발생했는가?
  - Why 3: 왜 그것을 미리 방지하지 못했는가?
  - Why 4: 왜 그런 시스템이 없었는가?
  - Why 5: 왜 그런 프로세스가 없었는가?

### 예방 조치 수립
- [ ] **모니터링 강화**
- [ ] **알림 시스템 개선**
- [ ] **자동화 도구 도입**
- [ ] **문서 업데이트**
- [ ] **팀 교육 실시**

### 프로세스 개선
- [ ] **체크리스트 업데이트**
- [ ] **도구 개선**
- [ ] **워크플로우 최적화**

---

## 🆘 에스컬레이션 가이드

### 도움 요청 시점
- 30분 내에 해결책을 찾지 못한 경우
- 문제 영향 범위가 확대되는 경우
- 데이터 손실 위험이 있는 경우
- 보안 관련 문제인 경우

### 도움 요청 방법
AI 어시스턴트에게 도움 요청 시:
```
"[문제 유형] 문제가 발생했어. 도움이 필요해.

상황:
- 발생 시점: [시간]
- 증상: [구체적 설명]
- 시도한 것: [지금까지 시도한 방법들]
- 로그: [관련 에러 메시지]

긴급도: Critical/High/Medium/Low"
```

---

## 💡 효과적인 문제 해결 팁

### 1. 차분한 접근
- 당황하지 말고 체계적으로 접근
- 추측보다는 데이터와 로그에 의존
- 한 번에 하나씩 변경하여 테스트

### 2. 협업 활용
- 동료와 함께 문제 분석
- 과거 유사 사례 검색
- 커뮤니티나 문서 활용

### 3. 지속적 개선
- 문제 해결 과정 기록
- 자주 발생하는 문제 패턴 분석
- 예방 중심의 사고

---

## 📞 긴급 상황 연락처

### 서비스 제공업체
- 도메인/DNS 업체: 
- 호스팅 업체: 
- CDN 서비스: 

### 유용한 리소스
- Stack Overflow
- GitHub Issues
- 공식 문서
- 커뮤니티 포럼

---

## 📚 관련 문서
- `daily-workflows.md` - 일상 워크플로우
- `deployment-checklist.md` - 배포 체크리스트
- `weekly-maintenance.md` - 정기 점검 가이드

체계적인 문제 해결 접근으로 빠르고 효과적인 해결을 달성하세요! 🎯